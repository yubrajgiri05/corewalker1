;/*FB_PKG_DELIM*/

__d("PolarisSponsoredPost.react",["CometErrorBoundary.react","PolarisFeedPageConstants","PolarisPost.react","PolarisReactRedux.react","PolarisSponsoredPostContext.react","PolarisStoriesLoggingUtils","PolarisTrackingCodeProvider.react","PolarisViewpointActionUtils","PolarisViewpointReact.react","err","polarisAdsSelectors.react","polarisFeedSelectors","polarisLogAction","polarisPostSelectors","polarisRelationshipSelectors.react","qex","react","usePolarisSelector","usePolarisSponsoredPostHasImageAsCta","usePolarisSponsoredPostHasPersistentCta","usePolarisSponsoredPostImpressionRefs","usePolarisSponsoredPostProfileClickLogger","usePolarisSponsoredPostRenderedLogging","usePolarisSponsoredPostViewpointActions","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useEffect,l=b.c,m=c("qex")._("1002");function n(a){var b,e,f=l(43),g=j(d("PolarisViewpointReact.react").ViewpointContext),h=j(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext),n=h.updateSponsoredPostContext;h=a.analyticsContext;var p=a.id,q;f[0]!==p?(q=function(a){return d("polarisPostSelectors").getPostById(a,p)},f[0]=p,f[1]=q):q=f[1];var r=d("PolarisReactRedux.react").useSelector(q);q=(q=c("usePolarisViewer")())==null?void 0:q.id;var s;f[2]!==r.owner?(s=function(a){return d("polarisRelationshipSelectors.react").getRelationship(a.relationships,(a=(a=r.owner)==null?void 0:a.id)!=null?a:"")},f[2]=r.owner,f[3]=s):s=f[3];s=d("PolarisReactRedux.react").useSelector(s);var t;f[4]!==a.position?(t=function(b){return d("polarisFeedSelectors").getGapToLastAd(b,a.position)},f[4]=a.position,f[5]=t):t=f[5];t=c("usePolarisSelector")(t);var u=d("polarisAdsSelectors.react").useFeedAdInfo(r==null?void 0:r.id,o),v=u==null?void 0:u.ad_id,w=u==null?void 0:u.tracking_token,x=d("usePolarisSponsoredPostHasImageAsCta").usePolarisSponsoredPostHasImageAsCta(r),y=d("usePolarisSponsoredPostHasPersistentCta").usePolarisSponsoredPostHasPersistentCta(r);b=(b=r.owner)==null?void 0:b.id;var z;f[6]!==r.id||f[7]!==b?(z=d("PolarisViewpointActionUtils").getMPKForStoryMedia(r.id,b),f[6]=r.id,f[7]=b,f[8]=z):z=f[8];b=z;f[9]!==r?(z=d("PolarisStoriesLoggingUtils").getMediaTypeFromPost(r),f[9]=r,f[10]=z):z=f[10];z=z;var A;f[11]!==s?(A=d("PolarisViewpointActionUtils").getFollowStatus(s),f[11]=s,f[12]=A):A=f[12];e=(e=r.owner)==null?void 0:e.id;var B;f[13]!==v||f[14]!==w||f[15]!==h||f[16]!==A||f[17]!==b||f[18]!==z||f[19]!==e?(B={adId:v,adTrackingToken:w,analyticsContext:h,followStatus:A,mpk:b,postMediaType:z,postOwnerId:e},f[13]=v,f[14]=w,f[15]=h,f[16]=A,f[17]=b,f[18]=z,f[19]=e,f[20]=B):B=f[20];var C=c("usePolarisSponsoredPostProfileClickLogger")(B);A=h===d("PolarisFeedPageConstants").FEED_PAGE_ANALYTICS_CONTEXT||h==="pastPostsFeedPage";b=h===d("PolarisFeedPageConstants").FEED_PAGE_MODAL_ANALYTICS_CONTEXT;var D=A||b;if(A){if(v==null)throw c("err")("Unexpected: a feed ad is being rendered without an ad id.");if(w==null)throw c("err")("Unexpected: a feed ad ("+v+")is being rendered without an ad tracking token.")}f[21]!==n||f[22]!==y||f[23]!==D||f[24]!==C||f[25]!==x?(z=function(){n({canUserSeePersistentCta:y,onProfileClick:D?C:function(){},singleImageAdAsCta:x})},e=[y,x,n,C,D],f[21]=n,f[22]=y,f[23]=D,f[24]=C,f[25]=x,f[26]=z,f[27]=e):(z=f[26],e=f[27]);k(z,e);b=String((B=a.position)!=null?B:null);z=t!=null?String(t):void 0;c("usePolarisSponsoredPostRenderedLogging")(p,h);f[28]!==g?(e=g==null?void 0:g.getViewport().height,f[28]=g,f[29]=e):e=f[29];B=c("usePolarisSponsoredPostViewpointActions")(r,h,v,w,q,s,e,m===!0,b,z);t=c("usePolarisSponsoredPostImpressionRefs")(p);f[30]!==A||f[31]!==B?(g=A?B:[],f[30]=A,f[31]=B,f[32]=g):g=f[32];f[33]!==a||f[34]!==t||f[35]!==g?(h=i.jsx(c("PolarisPost.react"),babelHelpers["extends"]({},a,{adImpressionRefs:t,isSponsored:!0,viewpointActionsForSponsoredPost:g})),f[33]=a,f[34]=t,f[35]=g,f[36]=h):h=f[36];v=h;if(!D)return v;if(f[37]!==r){q=(w=d("PolarisViewpointActionUtils").getMPKForFeedMedia(r))!=null?w:"";f[37]=r;f[38]=q}else q=f[38];e=(s=u==null?void 0:u.tracking_token)!=null?s:"";f[39]!==q||f[40]!==e||f[41]!==v?(b=i.jsx(c("PolarisTrackingCodeProvider.react"),{isSponsored:!0,m_pk:q,trackingToken:e,children:v}),f[39]=q,f[40]=e,f[41]=v,f[42]=b):b=f[42];return b}function o(a){return a}function p(){c("polarisLogAction")("feedUnitFailure",{source:"PolarisSponsoredPost"})}function a(a){var b=l(2),e;b[0]!==a?(e=i.jsx(c("CometErrorBoundary.react"),{fallback:q,onError:p,children:i.jsx(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContextProvider,{children:i.jsx(n,babelHelpers["extends"]({},a))})}),b[0]=a,b[1]=e):e=b[1];return e}function q(a){return null}g["default"]=a}),98);
__d("PolarisFeedPagePostModal.react",["CometErrorBoundary.react","FBLogger","PolarisIsLoggedInDesktop","PolarisLinkBuilder","PolarisPost.react","PolarisPostModal.react","PolarisReactRedux.react","PolarisRoutes","PolarisSponsoredPost.react","err","nullthrows","polarisPostSelectors","react","usePolarisFeedAnalyticsContext"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.c;function a(a){var b,e=k(23),f=a.mediaIdUFI,g=a.onClose,h=a.onOpen,m=a.postId;a=a.sidecarIndex;var n,o;e[0]!==g?(n=function(){return function(){g()}},o=[g],e[0]=g,e[1]=n,e[2]=o):(n=e[1],o=e[2]);j(n,o);e[3]!==m?(n=function(a){return d("polarisPostSelectors").getPostById(a,m)},e[3]=m,e[4]=n):n=e[4];o=d("PolarisReactRedux.react").useSelector(n);e[5]!==o?(n=c("nullthrows")(o),e[5]=o,e[6]=n):n=e[6];o=n;n=d("PolarisReactRedux.react").useSelector(l);var p=new Set(Array.from(n.keys()));n=o.code;o=o.dimensions;var q=c("usePolarisFeedAnalyticsContext")(),r=function(a){c("FBLogger")("ig_web").catching(a),p.has(m)?c("FBLogger")("ig_web").catching(c("err")("PolarisFeedPagePostModal.react threw an error for ad in Relay",m)):c("FBLogger")("ig_web").catching(c("err")("PolarisFeedPagePostModal.react threw an error for post in Relay",m))},s=c("CometErrorBoundary.react"),t=c("PolarisPostModal.react"),u="post-modal";u=d("PolarisLinkBuilder").buildMediaLink;var v=d("PolarisRoutes").FEED_PATH;n=n||"";a=p.has(m)?i.jsx(c("PolarisSponsoredPost.react"),{analyticsContext:q+"Modal",autoplay:d("PolarisIsLoggedInDesktop").isLoggedInDesktop(),id:m,initialCarouselIndex:(b=a)!=null?b:void 0,isVisible:!0,visiblePosition:0}):i.jsx(c("PolarisPost.react"),{analyticsContext:q+"Modal",autoplay:d("PolarisIsLoggedInDesktop").isLoggedInDesktop(),id:m,initialCarouselIndex:(b=a)!=null?b:void 0,isVisible:!0,visiblePosition:0});e[7]!==t||e[8]!==q||e[9]!==o||e[10]!==u||e[11]!==v||e[12]!==g||e[13]!==h||e[14]!==n||e[15]!==m||e[16]!==f||e[17]!==a?(b=i.jsx(t,{analyticsContext:q,"data-testid":void 0,dimensions:o,mediaLinkBuilder:u,modalEntryPath:v,onClose:g,onOpen:h,postCode:n,postId:m,postModalMediaUFI:f,children:a}),e[7]=t,e[8]=q,e[9]=o,e[10]=u,e[11]=v,e[12]=g,e[13]=h,e[14]=n,e[15]=m,e[16]=f,e[17]=a,e[18]=b):b=e[18];e[19]!==s||e[20]!==r||e[21]!==b?(t=i.jsx(s,{onError:r,children:b}),e[19]=s,e[20]=r,e[21]=b,e[22]=t):t=e[22];return t}function l(a){return a.ads.feed}g["default"]=a}),98);
__d("PolarisNewPostsPill.react",["fbt","PolarisPill.react","polarisLogAction","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(6),d=a.onClick;b[0]!==d?(a=function(){c("polarisLogAction")("newPostsPillClick"),d()},b[0]=d,b[1]=a):a=b[1];a=a;var e;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(e="xds687c xixxii4 x17qophe x1n327nk",b[2]=e):e=b[2];var f;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._("__JHASH__0iQ7o-ke_8i__JHASH__"),b[3]=f):f=b[3];b[4]!==a?(e=k.jsx("div",{className:e,children:k.jsx(c("PolarisPill.react"),{marginTop:2,onClick:a,children:f})}),b[4]=a,b[5]=e):e=b[5];return e}g["default"]=a}),226);
__d("PolarisLightweightNewPostsPill.react",["InstagramODS","PolarisNewPostsPill.react","PolarisNewPostsPillActions","PolarisReactRedux.react","XPolarisFeedControllerRouteBuilder","polarisNewPostsPillSelectors","react","useCometRouterDispatcher","usePolarisLightweightNewPostsPillCheck"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef,l=b.c;function a(){var a=l(24),b=d("PolarisReactRedux.react").useSelector(d("polarisNewPostsPillSelectors").checkHasNewPosts),e=d("PolarisReactRedux.react").useSelector(d("polarisNewPostsPillSelectors").getDocumentVisibilityHiddenTimestamp),f=c("useCometRouterDispatcher")(),g=d("PolarisReactRedux.react").useDispatch(),h=c("usePolarisLightweightNewPostsPillCheck")(),m=k(!0),n;a[0]!==h||a[1]!==e||a[2]!==g?(n=function(){if(document.visibilityState==="visible")h(e);else{var a=Date.now();g(d("PolarisNewPostsPillActions").setDocumentVisibilityHiddenTimestamp(a))}},a[0]=h,a[1]=e,a[2]=g,a[3]=n):n=a[3];var o=n;a[4]!==g||a[5]!==f?(n=function(){c("InstagramODS").incr("web.feed.lightweight_new_posts_pill.triggered");g(d("PolarisNewPostsPillActions").setNewPostsPillVisibility(!1));var a=c("XPolarisFeedControllerRouteBuilder").buildURL({}),b={refreshFeed:!0};f==null?void 0:f.go(a,{passthroughProps:b})},a[4]=g,a[5]=f,a[6]=n):n=a[6];var p=n;a[7]!==b||a[8]!==p?(n=function(){b===!0&&window.scrollY===0&&p()},a[7]=b,a[8]=p,a[9]=n):n=a[9];var q=n,r;a[10]!==o||a[11]!==q?(n=function(){document.addEventListener("visibilitychange",o);document.addEventListener("scroll",q);return function(){document.removeEventListener("visibilitychange",o),document.removeEventListener("scroll",q)}},r=[o,q],a[10]=o,a[11]=q,a[12]=n,a[13]=r):(n=a[12],r=a[13]);j(n,r);a[14]!==b||a[15]!==p?(n=function(){m.current===!0&&(m.current=!1,b===!0&&p())},a[14]=b,a[15]=p,a[16]=n):n=a[16];a[17]!==h||a[18]!==b||a[19]!==p?(r=[h,b,p],a[17]=h,a[18]=b,a[19]=p,a[20]=r):r=a[20];j(n,r);a[21]!==b||a[22]!==p?(n=b?i.jsx(c("PolarisNewPostsPill.react"),{onClick:p}):null,a[21]=b,a[22]=p,a[23]=n):n=a[23];return n}g["default"]=a}),98);